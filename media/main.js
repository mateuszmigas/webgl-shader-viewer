!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r="SHADERS",o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},a={emptyItem:!0},u=function(e,t,n){var r=o(o({},a),n),u=document.createElement("select");u.className="dropdown-base "+t;var c=null,l=[],s=function(t){e(c=t)};u.onchange=function(){var e=l.find((function(e){return e.item.id===u.value}));e.item.id?s(e.item):s(null)};return[u,{setItems:function(e){u.innerHTML="",l.length=0,e.find((function(e){return e.id===(null==c?void 0:c.id)}))||s(null),(r.emptyItem?i([{id:"",display:""}],e):i(e)).forEach((function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.display,t.selected=e.id===(null==c?void 0:c.id),u.appendChild(t),l.push({element:t,item:e})}))},getItems:function(){return l.map((function(e){return e.item}))},setSelectedItemById:function(e){s(null),l.forEach((function(t){t.item.id===e?(t.element.selected=!0,s(t.item)):t.element.selected=!1}))},getSelectedItem:function(){return c},clearSelection:function(){l.forEach((function(e){return e.element.selected=!1})),s(null)}}]},c=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},l=acquireVsCodeApi(),s=function(){function e(){var e=this;this.eventListeners=[],window.addEventListener("message",(function(t){e.eventListeners.forEach((function(e){return e(t.data)}))}))}return e.prototype.getShaderDocuments=function(){var e=this,t=c();return l.postMessage({type:"getShaderDocuments",id:t}),new Promise((function(n){var r=function(o){"getShaderDocuments"===o.type&&o.id===t&&(n(o.payload.files),e.removeListener(r))};e.eventListeners.push(r)}))},e.prototype.getDocumentText=function(e){var t=this,n=c();return l.postMessage({type:"getDocumentText",id:n,payload:{fileName:e}}),new Promise((function(e){var r=function(o){"getDocumentText"===o.type&&o.id===n&&(e(o.payload.text),t.removeListener(r))};t.eventListeners.push(r)}))},e.prototype.subscribeToDocumentSave=function(e,t){var n=this;l.postMessage({type:"subscribeToDocumentTextChange",payload:{fileName:e}});var r=function(n){"onDocumentTextChange"===n.type&&n.payload.filePath===e&&t(n.payload.text)};return this.eventListeners.push(r),function(){n.removeListener(r),l.postMessage({type:"unsubscribeToDocumentTextChange",payload:{fileName:e}})}},e.prototype.removeListener=function(e){var t,n,r;t=this.eventListeners,n=e,(r=t.indexOf(n))>-1&&t.splice(r,1)},e}(),f=function(e,t){var n=document.createElement("h3");return n.textContent=e,n.className=t+" section-title",{element:n}},d=function(e,t,n){var r=document.createElement("button");return r.onclick=n,r.className=t,r.textContent=e,{element:r}},p=function(e,t,n){var r=document.createElement("div");r.className=t+" options-wrapper";var o=document.createElement("label");return o.className="options-label",o.textContent=n,e.className=e.className+" options-content",r.appendChild(o),r.appendChild(e),r},m=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},v=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},h=function(e,t){var n=document.createElement("div");return n.className=e,null==t||t.forEach((function(e){return n.appendChild(e)})),n};m(void 0,void 0,void 0,(function(){var e,t,n,o,i,a,c,l,x,y,b,g,w,S,C,T;return v(this,(function(E){var D,L,N;return e=new s,t=document.getElementById("viewer"),n=h("viewer-options"),o=h("viewer-shader-options"),D="viewer-content",L=document.createElement("canvas"),N=L.getContext("2d"),L.className=D,L.width=500,L.height=500,N.fillStyle="green",N.fillRect(150,150,200,450),i=L,t.appendChild(i),t.appendChild(n),y=function(){o.innerHTML="",console.log({fragment:x,vertex:l})},n.appendChild(h("viewer-shaders-title",[f(r,"").element,d("Sync","viewer-refresh-button",(function(){e.getShaderDocuments().then((function(e){var t=e.map((function(e){return{id:e.filePath,display:e.fileName}}));w.setItems(t),T.setItems(t)}))})).element])),b=u((function(t){return m(void 0,void 0,void 0,(function(){var n;return v(this,(function(r){switch(r.label){case 0:return null==a||a(),t&&(a=e.subscribeToDocumentSave(t.id,(function(e){l=e,y()}))),t?[4,e.getDocumentText(t.id)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n="",r.label=3;case 3:return l=n,y(),[2]}}))}))})),g=b[0],w=b[1],n.appendChild(p(g,"viewer-vertex-shader-selector","Vertex Shader")),S=u((function(t){return m(void 0,void 0,void 0,(function(){var n;return v(this,(function(r){switch(r.label){case 0:return null==c||c(),t&&(c=e.subscribeToDocumentSave(t.id,(function(e){x=e,y()}))),t?[4,e.getDocumentText(t.id)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n="",r.label=3;case 3:return x=n,y(),[2]}}))}))})),C=S[0],T=S[1],n.appendChild(p(C,"viewer-fragment-shader-selector","Fragment Shader")),n.appendChild(o),[2]}))}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RyYW5zbGF0aW9ucy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdmlld2VyL2NvbXBvbmVudHMvZHJvcGRvd24udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzLnRzIiwid2VicGFjazovLy8uL3NyYy92aWV3ZXIvY29tbXVuaWNhdGlvblByb3h5LnRzIiwid2VicGFjazovLy8uL3NyYy92aWV3ZXIvY29tcG9uZW50cy9jcmVhdGVTZWN0aW9uVGl0bGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ZpZXdlci9jb21wb25lbnRzL2NyZWF0ZUZBQnV0dG9uLnRzIiwid2VicGFjazovLy8uL3NyYy92aWV3ZXIvY29tcG9uZW50cy93cmFwcGVycy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdmlld2VyL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidHJhbnNsYXRpb25zIiwiZGVmYXVsdE9wdGlvbnMiLCJlbXB0eUl0ZW0iLCJjcmVhdGVEcm9wZG93biIsIm9uQ2hhbmdlIiwiY2xhc3NOYW1lIiwib3B0aW9ucyIsImNvbWJpbmVkT3B0aW9ucyIsImVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZWxlY3RlZEl0ZW0iLCJpdGVtRWxlbWVudHMiLCJzZXRTZWxlY3RlZEl0ZW0iLCJpdGVtIiwib25jaGFuZ2UiLCJmb3VuZEVsZW1lbnQiLCJmaW5kIiwiZSIsImlkIiwic2V0SXRlbXMiLCJpdGVtcyIsImlubmVySFRNTCIsImxlbmd0aCIsImRpc3BsYXkiLCJmb3JFYWNoIiwib3B0aW9uIiwidGV4dENvbnRlbnQiLCJzZWxlY3RlZCIsImFwcGVuZENoaWxkIiwicHVzaCIsImdldEl0ZW1zIiwibWFwIiwiaWUiLCJzZXRTZWxlY3RlZEl0ZW1CeUlkIiwiZ2V0U2VsZWN0ZWRJdGVtIiwiY2xlYXJTZWxlY3Rpb24iLCJ1dWlkdjQiLCJyZXBsYWNlIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwiYWNxdWlyZVZzQ29kZUFwaSIsImV2ZW50TGlzdGVuZXJzIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwibGlzdGVuZXIiLCJkYXRhIiwiZ2V0U2hhZGVyRG9jdW1lbnRzIiwibWVzc2FnZUlkIiwicG9zdE1lc3NhZ2UiLCJ0eXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJtZXNzYWdlIiwicGF5bG9hZCIsImZpbGVzIiwicmVtb3ZlTGlzdGVuZXIiLCJnZXREb2N1bWVudFRleHQiLCJmaWxlTmFtZSIsInRleHQiLCJzdWJzY3JpYmVUb0RvY3VtZW50U2F2ZSIsImZpbGVQYXRoIiwiY2FsbGJhY2siLCJ0aGlzIiwiYXJyYXkiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJjcmVhdGVTZWN0aW9uVGl0bGUiLCJjcmVhdGVGQUJ1dHRvbiIsIm9uQ2xpY2siLCJidXR0b24iLCJvbmNsaWNrIiwid2l0aExhYmVsIiwid3JhcHBlciIsImxhYmVsIiwiY3JlYXRlRGl2U2VjdGlvbiIsImNoaWxkcmVuIiwiZGl2IiwiY2FudmFzIiwiY29udGV4dCIsInZzY29kZUFwaSIsInZpZXdlciIsImdldEVsZW1lbnRCeUlkIiwidmlld2VyT3B0aW9ucyIsInNoYWRlck9wdGlvbnMiLCJnZXRDb250ZXh0Iiwid2lkdGgiLCJoZWlnaHQiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndlYkdMQ2FudmFzIiwib25TaGFkZXJDb250ZW50Q2hhbmdlZCIsImNvbnNvbGUiLCJsb2ciLCJmcmFnbWVudCIsInNlbGVjdGVkRnJhZ21lbnRDb250ZW50IiwidmVydGV4Iiwic2VsZWN0ZWRWZXJ0ZXhDb250ZW50IiwidGhlbiIsInNkIiwiZiIsInZlcnRleERyb3Bkb3duQ29udHJvbGxlciIsImZyYWdtZW50RHJvcGRvd25Db250cm9sbGVyIiwibmV3VmVydGV4Iiwic2VsZWN0ZWRWZXJ0ZXhGaWxlV2F0Y2hlclVuc3Vic2NyaWJlIiwibmV3Q29udGVudCIsInZlcnRleERyb3Bkb3duRWxlbWVudCIsIm5ld0ZyYWdtZW50Iiwic2VsZWN0ZWRGcmFnbWVudEZpbGVXYXRjaGVyVW5zdWJzY3JpYmUiLCJmcmFnbWVudERyb3Bkb3duRWxlbWVudCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FB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RUFBVXJCLHdCQUMvQzRDLEVBQVV2RixJQUFJLFNBQUN5RixHQUNiUixFQUF3QlEsRUFDeEJkLFFBSWtCWSxFQUFZLEdBQU12QixFQUFVeEIsZ0JBQWdCK0MsRUFBVXZGLEtBQXRELE0sY0FBWSxXLGFBQWdELEssd0JBQXBGaUYsRUFBd0IsRUFDeEJOLEksY0FiR2UsRUFBcUIsS0FBRUwsRUFBd0IsS0FnQnREbEIsRUFBY3pELFlBQ1o4QyxFQUNFa0MsRUFDQSxnQ0FDQSxrQkFJRSxFQUF3RDFHLEdBQzVELFNBQU8yRyxHQUFXLDBDLCtEQUNoQkMsYUFFSUQsSUFDRkMsRUFBeUM1QixFQUFVckIsd0JBQ2pEZ0QsRUFBWTNGLElBQUksU0FBQ3lGLEdBQ2ZWLEVBQTBCVSxFQUMxQmQsUUFJb0JnQixFQUFjLEdBQU0zQixFQUFVeEIsZ0JBQWdCbUQsRUFBWTNGLEtBQTFELE0sY0FBYyxXLGFBQWtELEssd0JBQTFGK0UsRUFBMEIsRUFDMUJKLEksY0FiR2tCLEVBQXVCLEtBQUVQLEVBQTBCLEtBZ0IxRG5CLEVBQWN6RCxZQUNaOEMsRUFDRXFDLEVBQ0Esa0NBQ0Esb0JBSUoxQixFQUFjekQsWUFBWTBELEciLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBjb25zdCB0cmFuc2xhdGlvbnMgPSB7XHJcbiAgICBzaGFkZXJzOiBcIlNIQURFUlNcIlxyXG59IiwiZXhwb3J0IHR5cGUgRHJvcGRvd25JdGVtID0ge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgZGlzcGxheTogc3RyaW5nO1xyXG59O1xyXG5cclxuY29uc3QgZGVmYXVsdE9wdGlvbnMgPSB7XHJcbiAgZW1wdHlJdGVtOiB0cnVlXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVEcm9wZG93biA9IChcclxuICAvL2luaXRpYWxWYWx1ZTogRHJvcGRvd25JdGVtIHwgbnVsbCxcclxuICBvbkNoYW5nZTogKGl0ZW06IERyb3Bkb3duSXRlbSB8IG51bGwpID0+IHZvaWQsXHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nLFxyXG4gIG9wdGlvbnM/OiB7IGVtcHR5SXRlbTogYm9vbGVhbiB9IC8vcGxhY2Vob2xkZXJcclxuKTogW1xyXG4gICAgSFRNTFNlbGVjdEVsZW1lbnQsXHJcbiAgICB7XHJcbiAgICAgIHNldEl0ZW1zOiAoaXRlbXM6IERyb3Bkb3duSXRlbVtdKSA9PiB2b2lkO1xyXG4gICAgICBnZXRJdGVtczogKCkgPT4gRHJvcGRvd25JdGVtW107XHJcbiAgICAgIHNldFNlbGVjdGVkSXRlbUJ5SWQ6IChpZDogc3RyaW5nKSA9PiB2b2lkO1xyXG4gICAgICBnZXRTZWxlY3RlZEl0ZW06ICgpID0+IERyb3Bkb3duSXRlbSB8IG51bGw7XHJcbiAgICAgIGNsZWFyU2VsZWN0aW9uOiAoKSA9PiB2b2lkO1xyXG4gICAgfVxyXG4gIF0gPT4ge1xyXG4gIGNvbnN0IGNvbWJpbmVkT3B0aW9ucyA9IHsgLi4uZGVmYXVsdE9wdGlvbnMsIC4uLm9wdGlvbnMgfTtcclxuICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcclxuICBlbGVtZW50LmNsYXNzTmFtZSA9IGBkcm9wZG93bi1iYXNlICR7Y2xhc3NOYW1lfWA7XHJcblxyXG4gIGxldCBzZWxlY3RlZEl0ZW06IERyb3Bkb3duSXRlbSB8IG51bGwgPSBudWxsO1xyXG4gIGxldCBpdGVtRWxlbWVudHM6IHsgZWxlbWVudDogSFRNTE9wdGlvbkVsZW1lbnQ7IGl0ZW06IERyb3Bkb3duSXRlbSB9W10gPSBbXTtcclxuICBjb25zdCBzZXRTZWxlY3RlZEl0ZW0gPSAoaXRlbTogRHJvcGRvd25JdGVtIHwgbnVsbCkgPT4ge1xyXG4gICAgc2VsZWN0ZWRJdGVtID0gaXRlbTtcclxuICAgIG9uQ2hhbmdlKHNlbGVjdGVkSXRlbSk7XHJcbiAgfTtcclxuXHJcbiAgZWxlbWVudC5vbmNoYW5nZSA9ICgpID0+IHtcclxuICAgIGNvbnN0IGZvdW5kRWxlbWVudCA9IGl0ZW1FbGVtZW50cy5maW5kKChlKSA9PiBlLml0ZW0uaWQgPT09IGVsZW1lbnQudmFsdWUpO1xyXG5cclxuICAgIGlmIChmb3VuZEVsZW1lbnQuaXRlbS5pZCkgc2V0U2VsZWN0ZWRJdGVtKGZvdW5kRWxlbWVudC5pdGVtKTtcclxuICAgIGVsc2Ugc2V0U2VsZWN0ZWRJdGVtKG51bGwpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IHNldEl0ZW1zID0gKGl0ZW1zOiBEcm9wZG93bkl0ZW1bXSkgPT4ge1xyXG4gICAgZWxlbWVudC5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgaXRlbUVsZW1lbnRzLmxlbmd0aCA9IDA7XHJcblxyXG4gICAgaWYgKCFpdGVtcy5maW5kKChpKSA9PiBpLmlkID09PSBzZWxlY3RlZEl0ZW0/LmlkKSkge1xyXG4gICAgICBzZXRTZWxlY3RlZEl0ZW0obnVsbCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbmV3SXRlbXMgPSBjb21iaW5lZE9wdGlvbnMuZW1wdHlJdGVtID8gW3sgaWQ6IFwiXCIsIGRpc3BsYXk6IFwiXCIgfSwgLi4uaXRlbXNdIDogWy4uLml0ZW1zXTtcclxuICAgIG5ld0l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcclxuICAgICAgb3B0aW9uLnZhbHVlID0gaXRlbS5pZDtcclxuICAgICAgb3B0aW9uLnRleHRDb250ZW50ID0gaXRlbS5kaXNwbGF5O1xyXG4gICAgICBvcHRpb24uc2VsZWN0ZWQgPSBpdGVtLmlkID09PSBzZWxlY3RlZEl0ZW0/LmlkO1xyXG4gICAgICBlbGVtZW50LmFwcGVuZENoaWxkKG9wdGlvbik7XHJcbiAgICAgIGl0ZW1FbGVtZW50cy5wdXNoKHsgZWxlbWVudDogb3B0aW9uLCBpdGVtIH0pO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZ2V0SXRlbXMgPSAoKSA9PiBpdGVtRWxlbWVudHMubWFwKChpZSkgPT4gaWUuaXRlbSk7XHJcbiAgY29uc3Qgc2V0U2VsZWN0ZWRJdGVtQnlJZCA9IChpZDogc3RyaW5nKSA9PiB7XHJcbiAgICBzZXRTZWxlY3RlZEl0ZW0obnVsbCk7XHJcbiAgICBpdGVtRWxlbWVudHMuZm9yRWFjaCgoaWUpID0+IHtcclxuICAgICAgaWYgKGllLml0ZW0uaWQgPT09IGlkKSB7XHJcbiAgICAgICAgaWUuZWxlbWVudC5zZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgc2V0U2VsZWN0ZWRJdGVtKGllLml0ZW0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGllLmVsZW1lbnQuc2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZ2V0U2VsZWN0ZWRJdGVtID0gKCkgPT4gc2VsZWN0ZWRJdGVtO1xyXG4gIGNvbnN0IGNsZWFyU2VsZWN0aW9uID0gKCkgPT4ge1xyXG4gICAgaXRlbUVsZW1lbnRzLmZvckVhY2goKGllKSA9PiAoaWUuZWxlbWVudC5zZWxlY3RlZCA9IGZhbHNlKSk7XHJcbiAgICBzZXRTZWxlY3RlZEl0ZW0obnVsbCk7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIFtcclxuICAgIGVsZW1lbnQsXHJcbiAgICB7XHJcbiAgICAgIHNldEl0ZW1zLFxyXG4gICAgICBnZXRJdGVtcyxcclxuICAgICAgc2V0U2VsZWN0ZWRJdGVtQnlJZCxcclxuICAgICAgZ2V0U2VsZWN0ZWRJdGVtLFxyXG4gICAgICBjbGVhclNlbGVjdGlvbixcclxuICAgIH0sXHJcbiAgXTtcclxufTtcclxuIiwiZXhwb3J0IGNvbnN0IHJlbW92ZSA9IDxUPihhcnJheTogVFtdLCBpdGVtOiBUKSA9PiB7XHJcbiAgICBjb25zdCBpbmRleCA9IGFycmF5LmluZGV4T2YoaXRlbSk7XHJcblxyXG4gICAgaWYgKGluZGV4ID4gLTEpIHtcclxuICAgICAgICBhcnJheS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuLy9odHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjExNzUyM1xyXG5leHBvcnQgY29uc3QgdXVpZHY0ID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkgKiAxNiB8IDAsIHYgPSBjID09ICd4JyA/IHIgOiAociAmIDB4MyB8IDB4OCk7XHJcbiAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xyXG4gICAgfSk7XHJcbn0iLCJpbXBvcnQgeyByZW1vdmUsIHV1aWR2NCB9IGZyb20gJy4vLi4vdXRpbHMnO1xyXG5kZWNsYXJlIGNvbnN0IGFjcXVpcmVWc0NvZGVBcGk6ICgpID0+IHtcclxuICAvL2dldFN0YXRlOiAoKSA9PiBhbnk7XHJcbiAgLy9zZXRTdGF0ZTogKHN0YXRlOiBhbnkpID0+IHZvaWQ7XHJcbiAgcG9zdE1lc3NhZ2U6IChtZXNzYWdlOiBWc0NvZGVBcGlQcm94eU1lc3NhZ2VSZXF1ZXN0KSA9PiB2b2lkO1xyXG59O1xyXG5leHBvcnQgY29uc3QgdnNjb2RlQXBpID0gYWNxdWlyZVZzQ29kZUFwaSgpO1xyXG5cclxuZXhwb3J0IHR5cGUgVnNDb2RlQXBpUHJveHlNZXNzYWdlUmVxdWVzdCA9XHJcbiAgfCB7IHR5cGU6IFwiZ2V0U2hhZGVyRG9jdW1lbnRzXCIsIGlkOiBzdHJpbmcsIH1cclxuICB8IHsgdHlwZTogXCJnZXREb2N1bWVudFRleHRcIiwgaWQ6IHN0cmluZywgcGF5bG9hZDogeyBmaWxlTmFtZTogc3RyaW5nIH0gfVxyXG4gIHwgeyB0eXBlOiBcInN1YnNjcmliZVRvRG9jdW1lbnRUZXh0Q2hhbmdlXCIsIHBheWxvYWQ6IHsgZmlsZU5hbWU6IHN0cmluZyB9IH1cclxuICB8IHsgdHlwZTogXCJ1bnN1YnNjcmliZVRvRG9jdW1lbnRUZXh0Q2hhbmdlXCIsIHBheWxvYWQ6IHsgZmlsZU5hbWU6IHN0cmluZyB9IH07XHJcblxyXG5leHBvcnQgdHlwZSBWc0NvZGVBcGlQcm94eU1lc3NhZ2VSZXNwb25zZSA9IHtcclxuICB0eXBlOiBcImdldFNoYWRlckRvY3VtZW50c1wiO1xyXG4gIGlkOiBzdHJpbmcsXHJcbiAgcGF5bG9hZDogeyBmaWxlczogeyBmaWxlUGF0aDogc3RyaW5nOyBmaWxlTmFtZTogc3RyaW5nIH1bXSB9O1xyXG59IHxcclxueyB0eXBlOiBcImdldERvY3VtZW50VGV4dFwiLCBpZDogc3RyaW5nLCBwYXlsb2FkOiB7IGZpbGVOYW1lOiBzdHJpbmcsIHRleHQ6IHN0cmluZyB9IH0gfFxyXG57IHR5cGU6IFwib25Eb2N1bWVudFRleHRDaGFuZ2VcIiwgcGF5bG9hZDogeyBmaWxlUGF0aDogc3RyaW5nLCB0ZXh0OiBzdHJpbmcgfSB9XHJcblxyXG5leHBvcnQgdHlwZSBVbnN1YnNjcmliZSA9ICgpID0+IHZvaWQ7XHJcblxyXG50eXBlIFByb3h5UmVzcG9uc2VMaXN0ZW5lciA9IChtZXNzYWdlOiBWc0NvZGVBcGlQcm94eU1lc3NhZ2VSZXNwb25zZSkgPT4gdm9pZDtcclxuXHJcbmV4cG9ydCBjbGFzcyBWc0NvZGVBcGlQcm94eSB7XHJcbiAgZXZlbnRMaXN0ZW5lcnM6IFByb3h5UmVzcG9uc2VMaXN0ZW5lcltdID0gW107XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIChldmVudCkgPT4ge1xyXG4gICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiBsaXN0ZW5lcihldmVudC5kYXRhKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFNoYWRlckRvY3VtZW50cygpIHtcclxuICAgIGNvbnN0IG1lc3NhZ2VJZCA9IHV1aWR2NCgpO1xyXG5cclxuICAgIHZzY29kZUFwaS5wb3N0TWVzc2FnZSh7XHJcbiAgICAgIHR5cGU6IFwiZ2V0U2hhZGVyRG9jdW1lbnRzXCIsXHJcbiAgICAgIGlkOiBtZXNzYWdlSWRcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IGZpbGVQYXRoOiBzdHJpbmc7IGZpbGVOYW1lOiBzdHJpbmcgfVtdPigocmVzb2x2ZSkgPT4ge1xyXG4gICAgICBjb25zdCBsaXN0ZW5lciA9IChtZXNzYWdlOiBWc0NvZGVBcGlQcm94eU1lc3NhZ2VSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIGlmIChtZXNzYWdlLnR5cGUgPT09IFwiZ2V0U2hhZGVyRG9jdW1lbnRzXCIgJiYgbWVzc2FnZS5pZCA9PT0gbWVzc2FnZUlkKSB7XHJcbiAgICAgICAgICByZXNvbHZlKG1lc3NhZ2UucGF5bG9hZC5maWxlcyk7XHJcbiAgICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKGxpc3RlbmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXREb2N1bWVudFRleHQoZmlsZU5hbWU6IHN0cmluZykge1xyXG4gICAgY29uc3QgbWVzc2FnZUlkID0gdXVpZHY0KCk7XHJcblxyXG4gICAgdnNjb2RlQXBpLnBvc3RNZXNzYWdlKHtcclxuICAgICAgdHlwZTogXCJnZXREb2N1bWVudFRleHRcIixcclxuICAgICAgaWQ6IG1lc3NhZ2VJZCxcclxuICAgICAgcGF5bG9hZDogeyBmaWxlTmFtZSB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8c3RyaW5nPigocmVzb2x2ZSkgPT4ge1xyXG4gICAgICBjb25zdCBsaXN0ZW5lciA9IChtZXNzYWdlOiBWc0NvZGVBcGlQcm94eU1lc3NhZ2VSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIGlmIChtZXNzYWdlLnR5cGUgPT09IFwiZ2V0RG9jdW1lbnRUZXh0XCIgJiYgbWVzc2FnZS5pZCA9PT0gbWVzc2FnZUlkKSB7XHJcbiAgICAgICAgICByZXNvbHZlKG1lc3NhZ2UucGF5bG9hZC50ZXh0KTtcclxuICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIobGlzdGVuZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHN1YnNjcmliZVRvRG9jdW1lbnRTYXZlKGZpbGVQYXRoOiBzdHJpbmcsIGNhbGxiYWNrOiAobmV3Q29udGVudDogc3RyaW5nKSA9PiB2b2lkKTogVW5zdWJzY3JpYmUge1xyXG4gICAgdnNjb2RlQXBpLnBvc3RNZXNzYWdlKHtcclxuICAgICAgdHlwZTogXCJzdWJzY3JpYmVUb0RvY3VtZW50VGV4dENoYW5nZVwiLFxyXG4gICAgICBwYXlsb2FkOiB7IGZpbGVOYW1lOiBmaWxlUGF0aCB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBsaXN0ZW5lciA9IChtZXNzYWdlOiBWc0NvZGVBcGlQcm94eU1lc3NhZ2VSZXNwb25zZSkgPT4ge1xyXG4gICAgICBpZiAobWVzc2FnZS50eXBlID09PSBcIm9uRG9jdW1lbnRUZXh0Q2hhbmdlXCIgJiYgbWVzc2FnZS5wYXlsb2FkLmZpbGVQYXRoID09PSBmaWxlUGF0aCkge1xyXG4gICAgICAgIGNhbGxiYWNrKG1lc3NhZ2UucGF5bG9hZC50ZXh0KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKGxpc3RlbmVyKTtcclxuICAgICAgdnNjb2RlQXBpLnBvc3RNZXNzYWdlKHsgdHlwZTogXCJ1bnN1YnNjcmliZVRvRG9jdW1lbnRUZXh0Q2hhbmdlXCIsIHBheWxvYWQ6IHsgZmlsZU5hbWU6IGZpbGVQYXRoIH0gfSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVtb3ZlTGlzdGVuZXIobGlzdGVuZXI6IFByb3h5UmVzcG9uc2VMaXN0ZW5lcikge1xyXG4gICAgcmVtb3ZlKHRoaXMuZXZlbnRMaXN0ZW5lcnMsIGxpc3RlbmVyKVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgY3JlYXRlU2VjdGlvblRpdGxlID0gKHRleHQ6IHN0cmluZywgY2xhc3NOYW1lOiBzdHJpbmcpID0+IHtcclxuICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgzXCIpO1xyXG4gIGVsZW1lbnQudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG4gIGVsZW1lbnQuY2xhc3NOYW1lID0gYCR7Y2xhc3NOYW1lfSBzZWN0aW9uLXRpdGxlYDtcclxuICByZXR1cm4geyBlbGVtZW50IH07XHJcbn07XHJcbiIsImV4cG9ydCBjb25zdCBjcmVhdGVGQUJ1dHRvbiA9IChcclxuICB0ZXh0OiBzdHJpbmcsXHJcbiAgY2xhc3NOYW1lOiBzdHJpbmcsXHJcbiAgb25DbGljazogKCkgPT4gdm9pZFxyXG4pID0+IHtcclxuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gIGJ1dHRvbi5vbmNsaWNrID0gb25DbGljaztcclxuICBidXR0b24uY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xyXG4gIGJ1dHRvbi50ZXh0Q29udGVudCA9IHRleHQ7XHJcbiAgcmV0dXJuIHsgZWxlbWVudDogYnV0dG9uIH07XHJcbn07XHJcbiIsImV4cG9ydCBjb25zdCB3aXRoTGFiZWwgPSAoXHJcbiAgZWxlbWVudDogSFRNTEVsZW1lbnQsXHJcbiAgY2xhc3NOYW1lOiBzdHJpbmcsXHJcbiAgdGV4dDogc3RyaW5nXHJcbikgPT4ge1xyXG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gIHdyYXBwZXIuY2xhc3NOYW1lID0gYCR7Y2xhc3NOYW1lfSBvcHRpb25zLXdyYXBwZXJgO1xyXG4gIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gIGxhYmVsLmNsYXNzTmFtZSA9IFwib3B0aW9ucy1sYWJlbFwiO1xyXG4gIGxhYmVsLnRleHRDb250ZW50ID0gdGV4dDtcclxuICBlbGVtZW50LmNsYXNzTmFtZSA9IGAke2VsZW1lbnQuY2xhc3NOYW1lfSBvcHRpb25zLWNvbnRlbnRgO1xyXG4gIHdyYXBwZXIuYXBwZW5kQ2hpbGQobGFiZWwpO1xyXG4gIHdyYXBwZXIuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XHJcbiAgcmV0dXJuIHdyYXBwZXI7XHJcbn07XHJcbiIsImltcG9ydCB7IHRyYW5zbGF0aW9ucyB9IGZyb20gJy4vLi4vdHJhbnNsYXRpb25zJztcclxuaW1wb3J0IHsgY3JlYXRlRHJvcGRvd24sIERyb3Bkb3duSXRlbSB9IGZyb20gXCIuL2NvbXBvbmVudHMvZHJvcGRvd25cIjtcclxuaW1wb3J0IHsgVW5zdWJzY3JpYmUsIFZzQ29kZUFwaVByb3h5IH0gZnJvbSBcIi4vY29tbXVuaWNhdGlvblByb3h5XCI7XHJcbmltcG9ydCB7IGNyZWF0ZVNlY3Rpb25UaXRsZSB9IGZyb20gXCIuL2NvbXBvbmVudHMvY3JlYXRlU2VjdGlvblRpdGxlXCI7XHJcbmltcG9ydCB7IGNyZWF0ZUZBQnV0dG9uIGFzIGNyZWF0ZUJ1dHRvbiB9IGZyb20gXCIuL2NvbXBvbmVudHMvY3JlYXRlRkFCdXR0b25cIjtcclxuaW1wb3J0IHsgd2l0aExhYmVsIH0gZnJvbSBcIi4vY29tcG9uZW50cy93cmFwcGVyc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVNYXRyaXgzLCBjcmVhdGVWZWN0b3IzLCBjcmVhdGVWZWN0b3I0IH0gZnJvbSBcIi4vY29tcG9uZW50cy9lZGl0VmVjdG9yM1wiO1xyXG5cclxuY29uc3QgY3JlYXRlRGl2U2VjdGlvbiA9IChjbGFzc05hbWU6IHN0cmluZywgY2hpbGRyZW4/OiBIVE1MRWxlbWVudFtdKSA9PiB7XHJcbiAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICBkaXYuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xyXG4gIGNoaWxkcmVuPy5mb3JFYWNoKGMgPT4gZGl2LmFwcGVuZENoaWxkKGMpKTtcclxuICByZXR1cm4gZGl2O1xyXG59O1xyXG5cclxuY29uc3QgY3JlYXRlQ2FudmFzID0gKGNsYXNzTmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICBjb25zdCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICBjYW52YXMuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xyXG4gIGNhbnZhcy53aWR0aCA9IDUwMDtcclxuICBjYW52YXMuaGVpZ2h0ID0gNTAwO1xyXG4gIGNvbnRleHQuZmlsbFN0eWxlID0gXCJncmVlblwiO1xyXG4gIGNvbnRleHQuZmlsbFJlY3QoMTUwLCAxNTAsIDIwMCwgNDUwKTtcclxuICByZXR1cm4gY2FudmFzO1xyXG59XHJcblxyXG5jb25zdCBjb21waWxlQW5kR2VuZXJhdGUgPSBhc3luYyAoKSA9PiB7XHJcbiAgLy9nZXQgc2hhZGVycyB0ZXh0XHJcbiAgLy9jb21waWxlIHNoYWRlclxyXG4gIC8vZ2VuZXJhdGUgc2hhZGVyIG9wdGlvbnNcclxuXHJcbiAgLy9vbGQgc2hhZGVyIG9wdGlvbnNcclxuICAvL25ldyBzaGFkZXIgb3B0aW9uc1xyXG4gIC8vYXBwbHkgY2hhbmdlIGlmOlxyXG4gIC8vbmFtZSArIHR5cGUgY2hhbmdlZFxyXG59XHJcbmNvbnN0IGFwcGVuZFdpdGhTaGFkZXJPcHRpb25zID0gKGVsZW1lbnQ6IEhUTUxFbGVtZW50KSA9PiB7XHJcbiAgZWxlbWVudC5hcHBlbmRDaGlsZCh3aXRoTGFiZWwoY3JlYXRlVmVjdG9yMygpWzBdLCBcIlwiLCBcInVfY29sb3JcIikpO1xyXG4gIGVsZW1lbnQuYXBwZW5kQ2hpbGQod2l0aExhYmVsKGNyZWF0ZVZlY3RvcjQoKVswXSwgXCJcIiwgXCJ1X2RpZmZ1c2VcIikpO1xyXG5cclxuICBjb25zdCBbbWF0M2VsLCBtYXQzY29uXSA9IGNyZWF0ZU1hdHJpeDMobmV3dmFsID0+IGNvbnNvbGUubG9nKG5ld3ZhbCkpO1xyXG4gIGNvbnN0IFtlZGlmZiwgY2RpZmZdID1cclxuICAgIGNyZWF0ZURyb3Bkb3duKFxyXG4gICAgICAoc2VsKSA9PiB7XHJcbiAgICAgICAgaWYgKCFzZWwpXHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgaWYgKHNlbC5pZCA9PT0gXCIwXCIpIHtcclxuICAgICAgICAgIG1hdDNjb24uc2V0UmVhZG9ubHkoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc2VsLmlkID09PSBcIjFcIikge1xyXG4gICAgICAgICAgbWF0M2Nvbi5zZXRSZWFkb25seSh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIFwiXCIsXHJcbiAgICAgIHsgZW1wdHlJdGVtOiBmYWxzZSB9XHJcbiAgICApO1xyXG5cclxuICBjZGlmZi5zZXRJdGVtcyhbeyBpZDogXCIwXCIsIGRpc3BsYXk6IFwiQ29sb3IgcGlja2VyXCIgfSwgeyBpZDogXCIxXCIsIGRpc3BsYXk6IFwiQ3VzdG9tMlwiIH1dKTtcclxuICBjZGlmZi5zZXRTZWxlY3RlZEl0ZW1CeUlkKFwiMFwiKTtcclxuXHJcbiAgZWxlbWVudC5hcHBlbmRDaGlsZChcclxuICAgIHdpdGhMYWJlbChcclxuICAgICAgY3JlYXRlRGl2U2VjdGlvbihcImNvbHVtbi13aXRoLWdhcFwiLFxyXG4gICAgICAgIFtlZGlmZiwgbWF0M2VsXSksIFwiXCIsIFwiZG9icmUgZGlmZnVzZVwiKSk7XHJcblxyXG4gIGVsZW1lbnQuYXBwZW5kQ2hpbGQoXHJcbiAgICB3aXRoTGFiZWwoXHJcbiAgICAgIGNyZWF0ZURpdlNlY3Rpb24oXCJjb2x1bW4td2l0aC1nYXBcIixcclxuICAgICAgICBbY3JlYXRlRHJvcGRvd24oXHJcbiAgICAgICAgICAobmV3RnJhZ21lbnQpID0+IHtcclxuICAgICAgICAgIH1cclxuICAgICAgICApWzBdLCBjcmVhdGVNYXRyaXgzKG5ld3ZhbCA9PiBjb25zb2xlLmxvZyhuZXd2YWwpKVswXV0pLCBcIlwiLCBcInVfZGlmZnVzZTJcIikpXHJcbiAgZWxlbWVudC5hcHBlbmRDaGlsZChcclxuICAgIHdpdGhMYWJlbChcclxuICAgICAgY3JlYXRlRGl2U2VjdGlvbihcImNvbHVtbi13aXRoLWdhcFwiLFxyXG4gICAgICAgIFtjcmVhdGVEcm9wZG93bihcclxuICAgICAgICAgIChuZXdGcmFnbWVudCkgPT4ge1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIClbMF0sIGNyZWF0ZU1hdHJpeDMobmV3dmFsID0+IGNvbnNvbGUubG9nKG5ld3ZhbCkpWzBdXSksIFwiXCIsIFwidV9kaWZmdXNlMlwiKSlcclxuXHJcbn1cclxuXHJcbmNvbnN0IGNyZWF0ZVZpZXdlciA9IGFzeW5jICgpID0+IHtcclxuICBjb25zdCB2c2NvZGVBcGkgPSBuZXcgVnNDb2RlQXBpUHJveHkoKTtcclxuICBjb25zdCB2aWV3ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZXdlclwiKTtcclxuICBjb25zdCB2aWV3ZXJPcHRpb25zID0gY3JlYXRlRGl2U2VjdGlvbihcInZpZXdlci1vcHRpb25zXCIpO1xyXG4gIGNvbnN0IHNoYWRlck9wdGlvbnMgPSBjcmVhdGVEaXZTZWN0aW9uKFwidmlld2VyLXNoYWRlci1vcHRpb25zXCIpO1xyXG4gIGNvbnN0IHdlYkdMQ2FudmFzID0gY3JlYXRlQ2FudmFzKFwidmlld2VyLWNvbnRlbnRcIik7XHJcblxyXG4gIHZpZXdlci5hcHBlbmRDaGlsZCh3ZWJHTENhbnZhcyk7XHJcbiAgdmlld2VyLmFwcGVuZENoaWxkKHZpZXdlck9wdGlvbnMpO1xyXG5cclxuICBsZXQgc2VsZWN0ZWRWZXJ0ZXhGaWxlV2F0Y2hlclVuc3Vic2NyaWJlOiBVbnN1YnNjcmliZSB8IHVuZGVmaW5lZDtcclxuICBsZXQgc2VsZWN0ZWRGcmFnbWVudEZpbGVXYXRjaGVyVW5zdWJzY3JpYmU6IFVuc3Vic2NyaWJlIHwgdW5kZWZpbmVkO1xyXG4gIGxldCBzZWxlY3RlZFZlcnRleENvbnRlbnQ6IHN0cmluZyB8IG51bGw7XHJcbiAgbGV0IHNlbGVjdGVkRnJhZ21lbnRDb250ZW50OiBzdHJpbmcgfCBudWxsO1xyXG5cclxuICBjb25zdCBvblNoYWRlckNvbnRlbnRDaGFuZ2VkID0gKCkgPT4ge1xyXG4gICAgc2hhZGVyT3B0aW9ucy5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgY29uc29sZS5sb2coe1xyXG4gICAgICBmcmFnbWVudDogc2VsZWN0ZWRGcmFnbWVudENvbnRlbnQsXHJcbiAgICAgIHZlcnRleDogc2VsZWN0ZWRWZXJ0ZXhDb250ZW50XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHZpZXdlck9wdGlvbnMuYXBwZW5kQ2hpbGQoXHJcbiAgICBjcmVhdGVEaXZTZWN0aW9uKFwidmlld2VyLXNoYWRlcnMtdGl0bGVcIiwgW1xyXG4gICAgICBjcmVhdGVTZWN0aW9uVGl0bGUodHJhbnNsYXRpb25zLnNoYWRlcnMsIFwiXCIpLmVsZW1lbnQsXHJcbiAgICAgIGNyZWF0ZUJ1dHRvbihcIlN5bmNcIiwgXCJ2aWV3ZXItcmVmcmVzaC1idXR0b25cIiwgKCkgPT4ge1xyXG4gICAgICAgIHZzY29kZUFwaS5nZXRTaGFkZXJEb2N1bWVudHMoKS50aGVuKChzZCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZmlsZXMgPSBzZC5tYXAoKGYpID0+ICh7XHJcbiAgICAgICAgICAgIGlkOiBmLmZpbGVQYXRoLFxyXG4gICAgICAgICAgICBkaXNwbGF5OiBmLmZpbGVOYW1lLFxyXG4gICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAgIHZlcnRleERyb3Bkb3duQ29udHJvbGxlci5zZXRJdGVtcyhmaWxlcyk7XHJcbiAgICAgICAgICBmcmFnbWVudERyb3Bkb3duQ29udHJvbGxlci5zZXRJdGVtcyhmaWxlcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pLmVsZW1lbnRcclxuICAgIF0pXHJcblxyXG4gICk7XHJcblxyXG4gIGNvbnN0IFt2ZXJ0ZXhEcm9wZG93bkVsZW1lbnQsIHZlcnRleERyb3Bkb3duQ29udHJvbGxlcl0gPSBjcmVhdGVEcm9wZG93bihcclxuICAgIGFzeW5jIChuZXdWZXJ0ZXgpID0+IHtcclxuICAgICAgc2VsZWN0ZWRWZXJ0ZXhGaWxlV2F0Y2hlclVuc3Vic2NyaWJlPy4oKTtcclxuXHJcbiAgICAgIGlmIChuZXdWZXJ0ZXgpIHtcclxuICAgICAgICBzZWxlY3RlZFZlcnRleEZpbGVXYXRjaGVyVW5zdWJzY3JpYmUgPSB2c2NvZGVBcGkuc3Vic2NyaWJlVG9Eb2N1bWVudFNhdmUoXHJcbiAgICAgICAgICBuZXdWZXJ0ZXguaWQsIChuZXdDb250ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkVmVydGV4Q29udGVudCA9IG5ld0NvbnRlbnQ7XHJcbiAgICAgICAgICAgIG9uU2hhZGVyQ29udGVudENoYW5nZWQoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBzZWxlY3RlZFZlcnRleENvbnRlbnQgPSBuZXdWZXJ0ZXggPyBhd2FpdCB2c2NvZGVBcGkuZ2V0RG9jdW1lbnRUZXh0KG5ld1ZlcnRleC5pZCkgOiBcIlwiO1xyXG4gICAgICBvblNoYWRlckNvbnRlbnRDaGFuZ2VkKCk7XHJcbiAgICB9XHJcbiAgKTtcclxuICB2aWV3ZXJPcHRpb25zLmFwcGVuZENoaWxkKFxyXG4gICAgd2l0aExhYmVsKFxyXG4gICAgICB2ZXJ0ZXhEcm9wZG93bkVsZW1lbnQsXHJcbiAgICAgIFwidmlld2VyLXZlcnRleC1zaGFkZXItc2VsZWN0b3JcIixcclxuICAgICAgXCJWZXJ0ZXggU2hhZGVyXCJcclxuICAgIClcclxuICApO1xyXG5cclxuICBjb25zdCBbZnJhZ21lbnREcm9wZG93bkVsZW1lbnQsIGZyYWdtZW50RHJvcGRvd25Db250cm9sbGVyXSA9IGNyZWF0ZURyb3Bkb3duKFxyXG4gICAgYXN5bmMgKG5ld0ZyYWdtZW50KSA9PiB7XHJcbiAgICAgIHNlbGVjdGVkRnJhZ21lbnRGaWxlV2F0Y2hlclVuc3Vic2NyaWJlPy4oKTtcclxuXHJcbiAgICAgIGlmIChuZXdGcmFnbWVudCkge1xyXG4gICAgICAgIHNlbGVjdGVkRnJhZ21lbnRGaWxlV2F0Y2hlclVuc3Vic2NyaWJlID0gdnNjb2RlQXBpLnN1YnNjcmliZVRvRG9jdW1lbnRTYXZlKFxyXG4gICAgICAgICAgbmV3RnJhZ21lbnQuaWQsIChuZXdDb250ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkRnJhZ21lbnRDb250ZW50ID0gbmV3Q29udGVudDtcclxuICAgICAgICAgICAgb25TaGFkZXJDb250ZW50Q2hhbmdlZCgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHNlbGVjdGVkRnJhZ21lbnRDb250ZW50ID0gbmV3RnJhZ21lbnQgPyBhd2FpdCB2c2NvZGVBcGkuZ2V0RG9jdW1lbnRUZXh0KG5ld0ZyYWdtZW50LmlkKSA6IFwiXCI7XHJcbiAgICAgIG9uU2hhZGVyQ29udGVudENoYW5nZWQoKTtcclxuICAgIH1cclxuICApO1xyXG4gIHZpZXdlck9wdGlvbnMuYXBwZW5kQ2hpbGQoXHJcbiAgICB3aXRoTGFiZWwoXHJcbiAgICAgIGZyYWdtZW50RHJvcGRvd25FbGVtZW50LFxyXG4gICAgICBcInZpZXdlci1mcmFnbWVudC1zaGFkZXItc2VsZWN0b3JcIixcclxuICAgICAgXCJGcmFnbWVudCBTaGFkZXJcIlxyXG4gICAgKVxyXG4gICk7XHJcblxyXG4gIHZpZXdlck9wdGlvbnMuYXBwZW5kQ2hpbGQoc2hhZGVyT3B0aW9ucyk7XHJcbn07XHJcblxyXG5jcmVhdGVWaWV3ZXIoKTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==